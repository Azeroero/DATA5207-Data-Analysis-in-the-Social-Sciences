---
title: 'DATA5207 Research Report'  
subtitle: 'An investigation on factors influencing domestic violence against males'
date: "29 December 2018"
author: '420033455'
output:
  pdf_document: default
  html_document:
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(plyr)
library(dplyr)
library(xlsx)
library(stringr)
library(ggplot2)
library(reshape2)
```

# Data Extraction, Transformation and Load
We need to extract the number of victims and offenders by gender from the BOSCAR dataset from URL...; 
The dataset contains hundreds of xlxs excel tables.
The dataset cotains information in 2016,
so we also need to use the 2016 census data to have a near-match, especially for LGA almalgamation ... and validity of data ...
- e.g Bankstown-Canturbury


The 2016 census data can be downloaded from URL.
After transformation, processed data are loaded (saved) in local storage for further usage.

```{r Data Transformation: 2016 Census Data}
#load and combine Census data
filenames <- dir(path = "./Data/NSW_LGA_2016/2016 Census GCP Local Government Areas for NSW", 
                 pattern = "csv", 
                 full.names = TRUE, 
                 recursive = TRUE)
census_data_list <- lapply(as.list(filenames), read.csv)
census_data <- join_all(census_data_list,"LGA_CODE_2016") #join all data by LGA_CODE
census_data <- census_data[!duplicated(as.list(census_data))] #remove duplicated columns


#load geo description data
meta_geo <- read.xlsx("./Data/NSW_LGA_2016/Metadata/2016Census_geog_desc_1st_and_2nd_release.xlsx",
                      "2016_ASGS_Non-ABS_Structures")


#merge census data with geo data
census_geo_data <- merge(
              meta_geo %>%
                dplyr::select(c("Census_Code_2016", "Census_Name_2016", "Area.sqkm")),   
              census_data %>%
                dplyr::mutate(Census_Code_2016 = as.factor(LGA_CODE_2016)),
              by="Census_Code_2016")


#remove "(A)", "(C)" in Census_Name_2016 and save into lga_name; A->Area C->City
for(i in 1:length(census_geo_data$Census_Code_2016)){
  census_geo_data$lga_name[i] <- str_trim(str_extract(
    as.character(census_geo_data$Census_Name_2016[i]),"^[^\\(]*"))
}

write.csv(census_geo_data, file="./Data/census_geo_data.csv")
```


```{r Data Transformation: BOSCAR 2016}
#load and combine crime data (BOSCAR)
filenames <- dir(path = "./Data/BOSCAR_LGA", 
                 pattern = "xlsx", 
                 full.names = TRUE, 
                 recursive = TRUE)

# initializing data frame
dv_data = data.frame(matrix(ncol = 4, nrow = length(boscar_data_list)))
names(dv_data) = c("male.victim", "female.victim", "male.offender", "female.offender")

# get numbers of victims by gender
boscar_data_list <- lapply(as.list(filenames), 
                           function(x) read.xlsx(x, sheetIndex = 3))



for(i in 1:length(boscar_data_list)){
  # assign "na" to 2.5; "na" in the dataset is a value between [1, 4] that cannot be revealed
  # to the public due to privacy and legal issues; so we take the mean 2.5
  levels(boscar_data_list[[i]][,3]) = c(levels(boscar_data_list[[i]][,3]), 2.5)
  boscar_data_list[[i]][,3][boscar_data_list[[i]][,3] == "na"] <- 2.5
   
  
  # manually sum all age group as Total number in the dataset contain "nc" values; and round up
  dv_data$male.victim[i] <- ceiling(sum(as.numeric(as.character(boscar_data_list[[i]][5,3])),
                                        as.numeric(as.character(boscar_data_list[[i]][6,3])),
                                        as.numeric(as.character(boscar_data_list[[i]][7,3])),
                                        as.numeric(as.character(boscar_data_list[[i]][8,3])),
                                        as.numeric(as.character(boscar_data_list[[i]][9,3])))) 
  
  dv_data$female.victim[i] <- ceiling(sum(as.numeric(as.character(boscar_data_list[[i]][11,3])),
                                        as.numeric(as.character(boscar_data_list[[i]][12,3])),
                                        as.numeric(as.character(boscar_data_list[[i]][13,3])),
                                        as.numeric(as.character(boscar_data_list[[i]][14,3])),
                                        as.numeric(as.character(boscar_data_list[[i]][15,3]))))   
  
  # only retrieve LGA name and store into lga_name
  dv_data$lga_name[i] <- str_sub(str_trim(str_extract(as.character(boscar_data_list[[i]][3,1]),
                                                      "^(?<string>.*)Local")),1,-7)
}


# get numbers of offenders by gender; there is no "na" value for offenders
boscar_data_list <- lapply(as.list(filenames), 
                           function(x) read.xlsx(x, sheetIndex = 4))
for(i in 1:length(boscar_data_list)){
  dv_data$male.offender[i] <- as.numeric(as.character(boscar_data_list[[i]][11,3]))
              
  dv_data$female.offender[i] <- as.numeric(as.character(boscar_data_list[[i]][18,3]))
}


# inner and outer join census_geo_data with dv_data
#all_data <- merge(census_geo_data, dv_data, by="lga_name", all=TRUE)
all_data <-  merge(census_geo_data, dv_data, by="lga_name")

write.csv(dv_data, file="./Data/dv_data.csv")
write.csv(all_data, file="./Data/dv_data.csv")
head(all_data, 20)

```


```{r descriptive analysis: domestic violence against man}
#sum of all victims and offender by LGA
all_data$all.victim <- all_data$male.victim + all_data$female.victim
all_data$all.offender <- all_data$male.offender + all_data$female.offender
all_data$male.victim.percentage <- all_data$male.victim/all_data$all.victim
all_data$female.victim.percentage <- all_data$female.victim/all_data$all.victim
all_data$male.offender.percentage <- all_data$male.offender/all_data$all.offender
all_data$female.offender.percentage <- all_data$female.offender/all_data$all.offender


grand_sum_male_victim <- sum(all_data$male.victim)
grand_sum_female_victim <- sum(all_data$female.victim)

grand_sum_male_offender <- sum(all_data$male.offender)
grand_sum_female_offender <- sum(all_data$female.offender)

grand_sum_all_victim <- sum(all_data$all.victim)
grand_sum_all_offender <- sum(all_data$all.offender)
grand_sum_male_victim_percentage <- grand_sum_male_victim/grand_sum_victim

#LGA and Male Victim Percentage acsending by percentage
lga_and_male_victim_percentage <- cbind(all_data$lga_name, all_data$male.victim.percentage, all_data$Tot_P_P)
lga_and_male_victim_percentage <- lga_and_male_victim_percentage[order(all_data$male.victim.percentage),]
lga_and_male_victim_percentage[all_data$Tot_P_P>mean(all_data$Tot_P_P),]

sd(all_data$male.victim.percentage)
scale(all_data$male.victim.percentage)


#Density plot of male and female victim percentage
percentage_density_plot_melt <- 
  melt(cbind(male.victim.percentage = all_data$male.victim.percentage,
                   female.victim.percentage = all_data$female.victim.percentage),
             measure.vars=c("male.victim.percentage", "female.victim.percentage")) %>%
  rename("gender" = Var2)


#TODO: Add aesthetic features ----------------------
ggplot(percentage_density_plot_melt, aes(x=value, color=gender)) + 
  geom_density() +
  geom_vline(aes(xintercept=mean(all_data$male.victim.percentage)),
             color="red", linetype="dashed", size=1) +
  geom_vline(aes(xintercept=mean(all_data$female.victim.percentage)),
             color="blue", linetype="dashed", size=1)



#Density plot of numbers of male and female victims 
density_plot_melt <- 
  melt(cbind(male.victim = all_data$male.victim,
             female.victim = all_data$female.victim,
             all.victim = all_data$all.victim),
             measure.vars=c("all.victim","male.victim", "female.victim")) %>%
  rename("gender" = Var2)


#TODO: Add aesthetic features ----------------------
ggplot(density_plot_melt, aes(x=value, color=gender)) + 
  geom_density() +
    geom_vline(aes(xintercept=mean(all_data$all.victim)),
             color="blue", linetype="dashed", size=1) +
  geom_vline(aes(xintercept=mean(all_data$male.victim)),
             color="red", linetype="dashed", size=1) +
  geom_vline(aes(xintercept=mean(all_data$female.victim)),
             color="green", linetype="dashed", size=1) +
  xlim(0, 500)



#simple plot of points
# plot(all_data$male.victim.percentage,
#      main="Male Victim Percentage in NSW, 2016",
#      xlab="Index", 
#      ylab = "Male Victim Percentage")
# abline(mean(grand_sum_male_victim_percentage),0)


#validation
#(all_data$male.victim.percentage+all_data$female.victim.percentage, 100)


```
This shows that in New South Wales, the percentage of male being the victims of domestic violence is 31.80%, roughly in line with the "1/3" claim.
















# Introduction 
The research will focus on male victims of domestic violence related assaults in New South Wales. Common factors that impact domestic violence against both genders may include unemployment rate, weekly income, household composition and so forth (Oliver, 2011).  We aim to investigate the effect of these factors on domestic violence within the context of NSW local government areas and explore whether they affect male victims to comparable or different extents.

\vspace{6mm}

# Literature 
The term “domestic violence” has historically been associated with the concept of female victims perpetrated by men. Countering to popular belief, however, numerous sources have revealed that approximately one-third victims of domestic violence in Australia are males (Australian Broadcasting Corporation, 2017) (Australian Bureau of Statistics, 2017) (Victorian Royal Commission , 2016). In fact, this has led to Men’s Right Movements groups voicing for men in recent years, with the preeminent one being the “One in Three Campaign” arguing that male victims of domestic violence have long been overlooked by the police, media and society (One in Three Campaign, 2009).

\vspace{6mm}

# Data
Further datasets that may be used

* All criminal incidents by LGA in 2017, provided by Bureau of Crime Statistics and Research (BOSCAR). This dataset includes gender information of domestic violence victims (Bureau of Crime Statistics and Research, 2017). 
* 2016 census data by LGA in NSW (Australian Bureau of Statistics, 2016), which is the latest census data available.

\newpage

# Methodology
It is expected that the investigation be conducted the with the following steps:

1.	Data collection and pre-processing
2.	Identify factors that impact domestic violence against both genders
3.	Explore the effect of these factors for male and female

\vspace{3mm}

## Data collection and pre-processing
The BOSCAR and 2016 census datasets both contain hundreds of tables that need to be downloaded from their respective web pages. Once the tables are ready, relevant information will be extracted, transformed and stored. In particular, the numbers of victims of each gender (male and female) will be summarized by LGA. As remoteness may be a contributing factor (Campo & Tayton, 2015), the data may be split by metro, regional and remote according to Australian Statistical Geography Standard (ASGS), if time permits. 

\vspace{3mm}

## Identify factors that impact domestic violence against both genders
Given the nature of the research topic, gender-biased factors will not be taken into consideration. Factors to be explored may include but not limited to unemployment rate, weekly income, household composition, etc. Correlation between these factors and domestic violence against both genders will be evaluated by conducting regression analysis. Models will be verified to determine if they can properly represent the trend of the data. It is highly possible that the choice of models will differ by factors. 

\vspace{3mm}

## Explore the effect of these factors against male and female 
Following a similar process, correlation between gender-impartial factors and domestic violence against male and female will be investigated. The results will then be compared with each other and those of domestic violence against both gender to identify the difference of impact. Furthermore, domestic violence (rate/number) on men will be used as test data for the models constructed from the previous step, which may provide in-depth perspective on the topic. 

\vspace{6mm}

# Expectation and Limitation
It is expected that several factors would be identified as impacting domestic violence rate against male more than against both gender or female. Although we aim to investigate the effect of gender-impartial factors only, it is noted that some of the factors, such as income, are usually biased against certain gender. Moreover, the models to be used in the analysis are simple and crude. Therefore, we concede that the expected results of the research will be far from accurate, but we hope they could shed some light to further researches on the topic in the future.


\newpage

# Bibliography 
Australian Broadcasting Corporation. (2017, Sep 26 ). What about men?: Challenging the MRA claim of a domestic violence conspiracy. Retrieved from ABC News: https://www.abc.net.au/triplej/programs/hack/challenging-the-mra-claim-of-a-domestic-violence-conspiracy/8632190

Australian Bureau of Statistics. (2016). 2016 Census Datapacks. Retrieved 12 7, 2018, from https://datapacks.censusdata.abs.gov.au/datapacks/
Australian Bureau of Statistics. (2017, November 08). 4906.0 - Personal Safety, Australia, 2016. Retrieved from Australian Bureau of Statistics: http://www.abs.gov.au/ausstats/abs@.nsf/mf/4906.0

Bureau of Crime Statistics and Research. (2017). NSW Local Government Area excel crime tables. Retrieved 12 7, 2018, from https://www.bocsar.nsw.gov.au/Pages/bocsar_crime_stats/bocsar_lgaexceltables.aspx

Campo, M., & Tayton, S. (2015, Dec). Domestic and family violence in regional, rural and remote communities. Retrieved 12 7, 2018, from https://aifs.gov.au/cfca/publications

Oliver, M. K. (2011). Domestic Violence: Factors, Perpetuation, Cultural Differences & Treatment. San Luis Obispo: California Polytechnic State University.
One in Three Campaign. (2009, Novermber). One in Three. (One in Three Campaign) Retrieved 12 07, 2018, from http://www.oneinthree.com.au

Victorian Royal Commission . (2016). Royal Commission into Family Violence Summary and recommendations. Melbourne: Victorian Government Printer.

