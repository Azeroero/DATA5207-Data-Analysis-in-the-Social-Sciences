---
title: "Lab 1+ Solution"
author: "Kun Zhang"
date: "3 December 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


# Smoking Data
```{r initialize}
smoke.data <- read.csv("./Data/Smoking/smoke_data.csv", head=TRUE, sep=",", na.strings=" ") #na.strings = " " blank
smoke.trend.1 <- ddply(smoke.data, .(wave, parsmk), summarise, smoke=mean(smkreg)) 

```

# ggplot Example
```{r }

names(smoke.trend.1)

```















library(dplyr)

issues = c(quo(us.data$fracking), quo(us.data$subsidise.renewables),
quo(us.data$fewer.migrants), quo(us.data$tariffs),
quo(us.data$tax.cuts.for.bus), quo(us.data$rich.poor.diffs),
quo(us.data$spend.more.infrastructure))

issues

#<quosure> is referenced as [[]]
us.issue.attitudes <- data.frame(matrix(nrow = 7, ncol = 1))


for(i in 1:7){
  us.issue.attitudes[i,] <- us.data %>%
  dplyr::group_by(!!issues[[i]]) %>%  # !! takes a single expression, evaluates it, and inlines the result 
  dplyr::summarise(sum.val = sum(weights)) %>%
  mutate(proportion = (sum.val / sum(sum.val)) * 100) %>%
  dplyr::select(-sum.val) %>%
  na.omit() %>%
  rename("response"= names(.)[1]) %>%
  subset(., response == "Strongly agree" | response == "Agree") %>%
  summarise(proportion = sum(proportion)) %>%
  dplyr::select(proportion)
}

us.issue.attitudes
us.issue.attitudes <- us.issue.attitudes %>%
rename("All voters"= names(.)[1]) %>%
mutate(issues = c("Permit more fracking",
"Subsidies for renewable energy sources",
"America should accept fewer immigrants",
"Tariffs on imports from China will help the economy",
"Tax cuts for businesses help grow the economy",
"Differences between rich and poor have become too large",
"Instead of cutting taxes, government should spend more on infrastructure"))

us.issue.attitudes
```

```{r key issues 2}




```










